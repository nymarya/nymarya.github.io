I"¬3<p>A tecnologia tem um papel primordial na inova√ß√£o c√≠vica, j√° que est√° ajudando a identificar problemas da sociedade para os governos e trazer solu√ß√µes, al√©m de melhorar o processo de tomadas de decis√£o. Dentre as aplica√ß√µes, podemos citar desde o controle de gasto de √°gua na cidade at√© encorajar a popula√ß√£o a engajar mais na pol√≠tica.</p>

<p>Mobilidade urbana √© um dos v√°rios aspectos para os quais as autoridades devem atentar. Sabendo que a locomo√ß√£o pode ser uma fonte substancial de estresse, vemos que o planejamento das vias tem um impacto direto na qualidade de vida das pessoas. Se pensarmos em sustentabilidade, a discuss√£o se torna ainda mais complexa. Surge a necessidade de ciclovias e, mais ainda, a oportunidade dos habitantes circularem pela cidade a p√©. Acessibilidade para pedestres tem um impacto consider√°vel na sa√∫de na sa√∫de, al√©m de promover um impacto positivo no meio ambiente.</p>

<p>Sabendo disso, neste post tentaremos medir caminhabilidade, a capacidade de acessar diferentes pontos importantes da cidade a p√©. A an√°lise usa dados de Natal, sendo feita atrav√©s de ci√™ncia de dados, dados abertos e mapas. Existem posts parecidos que serviram de inspira√ß√£o, como esses de <a href="https://medium.com/pizzadedados/utilizando-dados-abertos-e-ci%C3%AAncia-de-dados-na-mobilidade-urbana-371a4c591639">Macei√≥</a>, <a href="https://medium.com/@matthewtenneyto/measuring-walking-times-across-toronto-to-nearest-ttc-stop-using-the-pedestrian-network-and-python-4263e0392a9b">Toronto</a>, e <a href="https://towardsdatascience.com/measuring-pedestrian-accessibility-97900f9e4d56">New York</a>.</p>

<p>Todo o c√≥digo necess√°rio est√° dispon√≠vel no <a href="https://github.com/nymarya/fear-the-walking-distance">reposit√≥rio</a>.</p>

<h2 id="primeiramente-os-dados">Primeiramente, os dados</h2>

<p>O plano aqui √© calcular as dist√¢ncias a p√© dentro de um bairro e comparar as diferen√ßas entre as √°reas. Mas antes disso, vamos nos aprofundar um pouco e recolher informa√ß√µes sobre as pessoas. Isso pode ser feito bem r√°pido, visto que o IBGE prov√™ dados sobre a renda e o n√∫mero de habitantes pela API <a href="sidra.ibge.gov.br">SIDRA</a>, ent√£o a biblioteca <code class="language-plaintext highlighter-rouge">requests</code> ser√° suficiente. A renda per capita e a popula√ß√£o s√£o descritas, respectivamente, pelas vari√°veis 842 e 841 da tabela 3170.</p>

<p>Agora vem a parte divertida. Como medir a acessibilidade para pedestres em um bairro? Buscando uma alternativa, pensamos nisso: escolher um ponto bem no meio da √°rea a medir a distancia dali at√© o ponto de interesse mais pr√≥ximo. Isso significa encontrar o centro, i.e. centr√≥ide, do pol√≠gono. Para nossa sorte, o GeoJSON que descreve a cidade tem a geometria da regi√£o que nos interessa, que consiste em um objeto do tipo Polygon, cujo centr√≥ide √© um atributo.</p>

<p>O pr√≥ximo passo √© calcular a dist√¢ncias em si. Criamos a rede com <a href="https://udst.github.io/pandana/network.html">Pandana</a>, que recupera os dados da <a href="https://wiki.openstreetmap.org/wiki/API">OpenStreetMap</a> de um jeito muito eficiente.</p>

<p>A biblioteca tamb√©m tem a funcionalidade de consultar os pontos de interesse da rede. Neste estudo, a busca √© por estabelecimentos que cobrem as necessidades b√°sicas: comida, educa√ß√£o, dinheiro, sa√∫de e seguran√ßa. Nos termos da API OSM, as tags s√£o ‚Äòhospital‚Äô, ‚Äòrestaurant‚Äô, ‚Äòbank‚Äô,‚Äôschool‚Äô, ‚Äòpolice‚Äô, and ‚Äòpharmacy‚Äô. Para manter esse post mais curto, os exemplos aqui usar√£o apenas escolas. Por favor, acesse o reposit√≥rio para o c√≥digo completo.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">]</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">osm</span><span class="p">.</span><span class="n">pdna_network_from_bbox</span><span class="p">(</span><span class="o">*</span><span class="n">bbox</span><span class="p">)</span>
<span class="n">schools</span> <span class="o">=</span> <span class="n">osm</span><span class="p">.</span><span class="n">node_query</span><span class="p">(</span><span class="o">*</span><span class="n">bbox</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="s">'"amenity"="school"'</span><span class="p">)</span>
</code></pre></div></div>

<p>Seguindo o fluxo sugerido na <a href="https://github.com/UDST/pandana/blob/dev/examples/Pandana-demo.ipynb">demo</a> disponibilizada na documenta√ß√£o do Pandana, chamamos <code class="language-plaintext highlighter-rouge">set_pois</code> para adicionar pontos √† rede. Isso √© feito separadamente para cada categoria. No exemplo abaixo, passamos os par√¢metros de longitude e latitude das escolas, bem como o n√∫mero de itens que a consulta que a fun√ß√£o deve retornar. Aqui, tamb√©m especificamos que queremos apenas os estabelecimentos dentro de um raio de 10km. O pr√≥ximo passo usar√° essa informa√ß√£o.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>net.set_pois("schools", 10000, 10, schools.lon, schools.lat)
</code></pre></div></div>

<p>Ent√£o o c√°lculo √© feito ao chamar  <code class="language-plaintext highlighter-rouge">nearest_pois</code> e passar a dist√¢ncia m√°xima e o n√∫mero de itens que devem ser retornados pela fun√ß√£o. O resultado √© uma tabela onde cada linha √© referente a um n√≥ x e cada coluna i representa o i-√©simo estabelecimento mais pr√≥ximo, de modo que cada c√©lula cont√©m a dist√¢ncia entre esses dois pontos.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">net</span><span class="p">.</span><span class="n">nearest_pois</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="s">"schools"</span><span class="p">,</span> <span class="n">num_pois</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div>
<img src="/images/posts/distances_table.png" />
</div>

<p>Finalmente, salvamos no dataframe o valor que est√° na coluna 1 e na linha referente ao n√≥ do bairro. E pronto, nossa base de dados est√° montada.</p>

<h3 id="hora-de-visualizar">Hora de visualizar!</h3>

<div>
<center>
<img src="https://media.giphy.com/media/rOTGSPxvJJY7m/giphy.gif" />
</center>
</div>

<p>O dataset est√° pronto, ent√£o √© hora de usar <a href="https://github.com/python-visualization/folium">Folium</a>, uma bilbioteca capaz de unir manipula√ß√£o de dados com Python e visualiza√ß√£o de mapas com a biblioteca JavaScript <a href="https://github.com/Leaflet/Leaflet">Leaflet</a>. Isso √© tudo que uma pessoa programadora precisa para exibir seus dados geogr√°ficos.</p>

<p>Antes de prosseguir, √© importante mencionar que Pandana possibilita criar visualiza√ß√µes bonitas, incluindo o mapa usado como capa desse post. A fun√ß√£o <code class="language-plaintext highlighter-rouge">aggregation</code> conta quantos estabelecimentos estavam num raio de 10km de cada n√≥ e o resultado √© bonito, mas dif√≠cil de interpretar. Ainda que exista uma ideia de onde a maioria das escolas est√° (no meio da cidade, onde os pontos s√£o mais vermelhos), mal d√° para reconhecer a cidade, pior ainda se quisessemos comparar os bairros.</p>

<div>
<img src="/images/posts/distances_cmap1.png" />
</div>

<p>Bom, vamos para os mapas interativos.</p>

<div>
<center>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/population.html" height="400" width="400"></iframe>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/income.html" height="400" width="400"></iframe> 
<figcaption>Esquerda: quanto mais escura a cor, maior a popula√ß√£o. Direita: quando mais escura a cor, maior a renda per capita</figcaption>   
</center>

</div>

<p>Os mapas mostram que, enquanto a popula√ß√£o est√° mais concentrada no norte, e em seguida na zona ao oeste, a renda segue uma tend√™ncia inversa. A renda m√©dia aumenta quando seguimos para o sul e √© ainda maior se olharmos para o leste, onde est√£o os bairros com maior renda per capita.</p>

<div>
<center>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/school.html" height="350" width="400"></iframe>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/restaurant.html" height="350" width="400"></iframe>  
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/pharmacy.html" height="350" width="400"></iframe>  
<figcaption>Esquerda: dist√¢ncia at√© a escola mais pr√≥xima. Centro: dist√¢ncia at√© o restaurante mais pr√≥ximo. Direita: dist√¢ncia at√© a farm√°cia mais pr√≥xima</figcaption>
</center>
</div>

<p>Quando analisamos a dist√¢ncia que algu√©m no centro de um bairro tem que se deslocar at√© a escola, farm√°cia ou o restaurante mais pr√≥ximo, vemos um padr√£o espacial. Bairros com menos acessibilidade, ou seja, coloridos com lil√°s ou roxo, est√£o localizados nas √°reas ao norte e oeste da cidade. Destaca-se o bairro Nossa Senhora da Apresenta√ß√£o que possui o tom de roxo escuro em todos os tr√™s mapas. Lagoa Azul, distrito vizinho, tem caracter√≠cticas semelhantes pois possui a cor mais escura em dois dos tr√™s mapas.</p>

<center>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/hospital.html" height="350" width="400"></iframe>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/police.html" height="350" width="400"></iframe>
<figcaption>Esquerda: dist√¢ncia at√© o hospital mais pr√≥ximo. Direita: dist√¢ncia at√© o posto de pol√≠cia mais pr√≥ximo</figcaption>
</center>

<p>No que diz respeito a hospitais e postos de pol√≠cia, h√° uma diferen√ßa significativa entre os dois lados do rio Potengi. Em ambos os mapas, os bairos em roxo est√£o exclusivamente no norte, o que significa dizer que os habitante dessa √°rea teriam que andar pelo menos 6km para chegar ao hospital ou posto de pol√≠cia mais pr√≥ximo. Temos tamb√©m alguns bairros na cor azul ao oeste e ao sul, onde a dist√¢ncia fica entre 2km e 6km, o que tamb√©m pode ser problem√°tico quando imaginamos ter que andar tanto para chegar a um hospital.</p>

<div>
<center>
<iframe src="https://nymarya.github.io/assets/htmls/fear_the_walking_distance/bank.html" height="380" width="400"></iframe>
<figcaption>Dist√¢ncia at√© o banco mais pr√≥ximo</figcaption>
</center>
</div>

<p>A an√°lise das dist√¢ncias para bancos distoa um pouco das anteriores. Aqui, os bairros ao oeste possuem cores mais escuras, o que indica dist√¢ncias maiores, do que os bairros ao norte.</p>

<p>Note que em todos os mapas os bairros ao leste s√£o coloridos com um azul claro, geralmente isso acontece em escala menor no sul,  mesmo que essa segunda regi√£o tenha um desempenho semelhante. Esse padr√£o condiz com a renda per capita, mais alta no sul e mais ainda em algumas partes da zona ao leste.</p>

<h3 id="considera√ß√µes-finais">Considera√ß√µes finais</h3>

<p>Dados abertos s√£o uma ferramenta essencial para empoderar os cidad√µes atrav√©s da informa√ß√£o, disponibilizando meios de tomar decis√µes e fazer cobran√ßas √†s autoridades. No caso do OpenStreetMap, sua √∫nica desvantagem √© a falta de confiabilidade. Por este motivo, √© importante valorizar intitui√ß√µes como IBGE, que n√£o apenas s√£o respons√°veis por coletar informa√ß√£o mas tamb√©m facilitar o acesso dos dados de alta qualidade.</p>

<p>Ainda que n√£o seja poss√≠vel tirar conclus√µes mais definitivas, visto que h√° uma chance dos dados de bairros como Nossa Senhora da Apresenta√ß√£o, Lagoa Azul e Guarap√©s estarem faltando, a informa√ß√£o disponibilizada nos diz que existe uma falta de acessibilidade nessas √°reas. Essa afirma√ß√£o condiz com as reclama√ß√µes dos moradores nas redes sociais e nos jornais locais. O fato de que a maioria desses bairros serem populosos implica que muitas pessoas podem sofrer com a falta de investimento. Ent√£o, respondendo a pergunta do t√≠tulo: Natal ainda tem um longo caminho pela frente no que diz respeito √† acessibilidade para pedestres.</p>

<p>Finalmente, trabalhos futuros incluem explorar mais do Pandana. H√° tamb√©m um interesse em testar outra abordagem para comparar as dist√¢ncias. A alternativa seria computar as dist√¢ncias de cada n√≥ dentro do bairro para o estabelecimento mais pr√≥ximo, para ent√£o calcular a m√©dia para os n√≥s da √°rea e realizar as compara√ß√µes.</p>

<p>E √© isso! Fique √† vontade para entrar em contato, fazer perguntas e sugerir novas ideias.</p>

<h2 id="links">Links</h2>

<p><a href="https://medium.com/@mayradazevedo/ate-onde-e-posivel-chegar-a-pe-em-natal-4e50d1e46685">Previous version of this study (PT-BR_)</a></p>

<p><a href="https://www.ecycle.com.br/walkability-caminhabilidade/">Walkability: entenda o que √© a caminhabilidade (PT-BR)</a></p>
:ET