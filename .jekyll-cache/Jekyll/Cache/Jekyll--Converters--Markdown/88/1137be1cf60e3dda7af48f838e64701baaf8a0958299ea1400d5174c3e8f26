I"æ<p>Este √© o primeiro post de uma s√©rie sobre deep learning, especialmente Redes Neurais Convolucionais (em ingl√™s: Convolutional Neural Networks, ou CNNs) que consiste de dois post te√≥ricos e um mais pr√°tico, discorrendo sobre um modelo espec√≠fico. Vamos come√ßar com o C da sigla em ingl√™s, CNN.</p>

<p><strong>Convolu√ß√£o</strong> √© um termo usado na √°rea da matem√°tica para descrever a opera√ß√£o sobre duas fun√ß√µes que produzem uma terceira fun√ß√£o expressando como a primeira √© modificada pela outra. Eu sempre me recordo de uma aula na qual o professor explicou esse conceito de uma maneira bem simples. Imagine que voc√™ est√° entre dois palcos durante um festival de m√∫sica: se voc√™ se mover em dire√ß√£o a um ou outro, ouvir√° melhor alguma das m√∫sicas. Se ficar no meio, os sinais ficam muito misturados. Esta confus√£o de ru√≠dos √© a convolu√ß√£o em a√ß√£o.</p>

<h2 id="sobre-imagens">Sobre imagens</h2>

<div align="center">
<img src="https://media.giphy.com/media/8b5gDEqjO5BKM/giphy.gif" />
</div>

<p>Primeiro, o b√°sico de imagens. Para o computador, uma imagem n√£o passa de de uma matrix de inteiros. Quando a imagem √© em tons de cinza, cada n√∫mero entre 0 e 255 representa a luminosidade de um pixel. Existem duas maneiras de representar figuras RGB. A primeira √© como um grupo de 3 inteiros que compoem um pixel, com cada elemento do trio representando o valor de vermelho, verde e azul, respectivamente. Na outra forma, a imagem possui dimens√µes mxnx3, tendo uma camada para cada cor.</p>

<p>Em rela√ß√£o a processamento de imagens, convolucionar significa executar v√°rias multiplica√ß√µes de matrizes entre a matrix que representa a imagem e a  [m√°scara](https://en.wikipedia.org/wiki/Kernel_(image_processing). Deste modo, n√≥s podemos aplicar filtros, seja para detec√ß√£o de bordas, efeitos de blurring ou de sharpening.</p>

<h2 id="tipos-de-convolu√ß√£o-de-imagem">Tipos de convolu√ß√£o de imagem</h2>

<p>Embora uma multiplica√ß√£o de matrizes convencional requeira que o n√∫mero de colunas da primeira matrix seja igual ao n√∫mero de linhas da segunda matriz, o processo de convolu√ß√£o n√£o possui este tipo de condi√ß√£o. As dimens√µes do kernel n√£o precisam bater com as da imagem, visto que a convolu√ß√£o n√£o equivale a um produto convecional. Ao inv√©s disso, a opera√ß√£o √© realizada sucessivamente sobre a figura, como se fosse uma janela deslizante movendo sobre a imagem.</p>

<p>Considerando que os formatos n√£o est√£o adequados, existem tipos de convolu√ß√£o cujos resultos tem dimens√µes diferentes. O m√©todo <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve2d.html">convolve</a> do m√≥dulo scipy possui tr√™s modos: <em>full</em>, no qual os sinais n√£o se sobrep√µe completamente nas bordas da opera√ß√£o e podem acontecer efeitos nas bordas; <em>same</em>, no qual o resultado tem o mesmo tamanho da imagem; e <em>valid</em>, onde o product consiste apenas dos elementos que n√£o dependem de zero-padding.</p>

<h2 id="sobre-matem√°tica">Sobre matem√°tica</h2>

<div align="center">
<img src="https://media.giphy.com/media/26xBI73gWquCBBCDe/giphy.gif" />
</div>

<p>A opera√ß√£o, como dito anteriormente, √© muito similiar √† multiplica√ß√£o de matrizes comum. As diferen√ßas come√ß√£m com o tamanho da matriz final. No modo <em>full</em>, a matriz resultante C tem tamanho <em>m</em> que combina o tamanho da matriz kernel K e a imagem B, conforma a equa√ß√£o abaixo:</p>

\[m = |K| + |B| - 1\]

<p>Os valores de \(C\) s√£o obtidos ao multiplicar K e B.</p>

\[C(i, j) = \sum_{p=0}^{i+1} \sum_{q=0}^{j+1} K(p,q) B(i - p + 1, j - q + 1)\]

<p>onde \(i\) e \(j\) s√£o posi√ß√µes em \(C\), e a nota√ß√£o \(M(a, b)\) denota a elemento na a-√©sima linha e b-√©sima coluna.</p>

<h2 id="convolucionar-para-aprender">Convolucionar para aprender</h2>

<p>A inspira√ß√£o de usar a ideia de convolu√ß√£o para construir um algoritmo de aprendizado de m√°quina vem de um mecanismo biol√≥gico encontrado no c√©rebro de mam√≠feros. O c√≥rtex visual contem grupos de neur√¥nios que s√£o modulados por <strong>campos receptivos</strong>, que ‚Äú<a href="https://en.wikipedia.org/wiki/Receptive_field">podem provocar rea√ß√µes neurais quando estimuladas</a>‚Äù. Campos receptivos podem se sobrepor e repetir entre c√©lulas visiznhas, de forma que atuam como filtros locais sobre o que recebem.</p>

<p>O <a href="https://doi.org/10.1113%2Fjphysiol.1968.sp008455">estudo</a>, que traz informa√ß√µes sobre a regi√£o, divide as c√©lulas em dois tipos: <em>simples</em>, que reagem a padr√µes espec√≠ficos de seu campo receptivo; e <em>complexas</em>, que tem campos receptivos maiores e n√£o s√£o sens√≠veis √† exata posi√ß√£o de um padr√£o na √°rea.</p>

<h2 id="discuss√£o">Discuss√£o</h2>

<p>√â importante (al√©m de interessante! ) aprender sobre todos os passos no processo do aprendizado computacional, e √© especialmente poderoso enteder a raz√£o pela qual o modelo foi criado de certa maneira. Nos pr√≥ximos posts, vamos continuar a ver teoria e depois investigar e treinar um modelo de deep learning.
At√© mais!</p>

<h2 id="para-saber-mais--refer√™ncias">Para saber mais &amp; refer√™ncias</h2>

<p><a href="https://docs.opencv.org/master/d2/d96/tutorial_py_table_of_contents_imgproc.html">Processamento de imagens com OpenCV</a></p>

<p><a href="https://cs231n.github.io/convolutional-networks/">CS123N</a></p>

<p><a href="https://www.nature.com/articles/s42003-018-0110-y">Activations of DCNNs are aligned with gamma band activty of human visual cortex</a></p>

<p><a href="https://books.google.com/books?id=8YrxWojxUA4C&amp;pg=PA106">Brain and the visual perception</a></p>

<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1363130">Receptive fields of single neurones in the cat‚Äôs striate cortex</a></p>
:ET