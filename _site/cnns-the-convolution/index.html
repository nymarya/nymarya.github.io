<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>CNNS: The convolution &#8211; Mayra Azevedo</title> <meta name="description" content="This post is the first of a series on deep learning, specifically Convolutional Neural Networks (CNNs), that consists of two theorical posts and one more practical, discussing a particular model. Let’s start with the C of the initials CNN."> <meta name="keywords" content="deep learning, CNN"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://i.stack.imgur.com/VC1TX.png"> <meta name="twitter:title" content="CNNS: The convolution"> <meta name="twitter:description" content="This post is the first of a series on deep learning, specifically Convolutional Neural Networks (CNNs), that consists of two theorical posts and one more practical, discussing a particular model. Let’s start with the C of the initials CNN."> <meta name="twitter:site" content="@nymaryah"> <meta name="twitter:creator" content="@nymaryah"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="CNNS: The convolution"> <meta property="og:description" content="This post is the first of a series on deep learning, specifically Convolutional Neural Networks (CNNs), that consists of two theorical posts and one more practical, discussing a particular model. Let’s start with the C of the initials CNN."> <meta property="og:url" content="http://localhost:4000/cnns-the-convolution/"> <meta property="og:site_name" content="Mayra Azevedo"> <meta property="og:image" content="http://localhost:4000/images/https://avatars0.githubusercontent.com/u/23341788?s=460&v=4"> <link rel="canonical" href="http://localhost:4000/cnns-the-convolution/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Mayra Azevedo" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-post {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://i.stack.imgur.com/VC1TX.png) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/workset.jpeg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/natown.jpg) no-repeat;background-size: cover;} </style> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'></script> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.css" type="text/css" /> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.css" type="text/css" /> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.js"></script> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.js"></script> <script type="text/javascript"> Bokeh.set_log_level("info"); </script> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"> <style> a {color: black;} a:hover { color: #8f6bff; } </style> </head> <body id="posts" class="inner-post-page"> <header class="navbar navbar-expand navbar-dark flex-column flex-row-reverse bd-navbar"> <div class="d-flex flex-row-reverse bd-highlight pull-right"> <div class="p-2 bd-highlight"> <a title="projects" href="../projects.html" > Projects </a> </div> <div class="p-2 bd-highlight"> <a href="../posts.html" title="posts">Posts</a> </div> <div class="p-2 bd-highlight"> <a href="http://localhost:4000" title="home" style="font-family: 'Raleway','Helvetica Neue',Helvetica,Arial,sans-serif; font-weight: 500">Home</a></div> </div> </header> <div style="height: 90%; overflow: auto;"> <div class="block-post"> <div class="content"> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">CNNS: The convolution </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#deep learning">deep learning</a></li> <li><a href="http://localhost:4000/tags#CNN">CNN</a></li> </ul> <div class="section-line reverse"> <em>/</em></div> </div> </div> </div> <div class="post"> <div class="inner-post post-content"> <div class="date-highlight">17/11/2019</div> <p>This post is the first of a series on deep learning, specifically Convolutional Neural Networks (CNNs), that consists of two theorical posts and one more practical, discussing a particular model. Let’s start with the C of the initials CNN.</p> <p><strong>Convolution</strong> is a term used in mathematics to describing the operation on two functions that produces a third function expressing how the shape of one is modified by the other. I always remember a class in which the teacher explained this idea using a very simplistic example. Imagine that you are standing between two stages during a music festival: if you move closer to one or another, you will listen better to one song. If you stay in the middle, the signals are too mixed. This confusion is the convolution in action.</p> <h2 id="talking-images">Talking images</h2> <div align="center"> <img src="https://media.giphy.com/media/8b5gDEqjO5BKM/giphy.gif" /> </div> <p>First, the basics of images. To the computer, an image is nothing but a matrix of integers. When the picture is b&amp;w, each integer between 0 and 255 represents the luminosity of the pixel. There are two ways of representing RGB figures. The first is a group of 3 integers that compose a pixel, with each of them representing red, blue, or green value. On another approach, the image with dimensions mxnx3 has one layer for each color.</p> <p>In terms of image processing, convolute means executing multiple matrix multiplications between the matrix representing the image and the [mask](https://en.wikipedia.org/wiki/Kernel_(image_processing). Hence, we can apply several transformation filters, such as edge detection, blurring and sharpening effects.</p> <h2 id="types-of-image-convolution">Types of image convolution</h2> <p>Although a conventional matrix multiplication requires that the number of columns of the 1st matrix must equal the number of rows of the 2nd matrix, the convolution process has no such condition. The kernel’s dimensions don’t need to match the image, as the convolution is not the same as a traditional product. Instead, the operation is repeated successively across the picture, as such as a sliding window moving over the image.</p> <p>Considering that the shapes do not match, there are several types of convolution that result in distinct dimensions. The <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve2d.html">convolve</a> method in the scipy module presents three modes: <em>full</em>, in which the signals do not overlap completely at the end-points of the operation and boundary effects may occur; <em>same</em>, in which the outcome is the same size as the image; and <em>valid</em>, where the product consists only of those elements that do not rely on zero-padding.</p> <h2 id="talking-math">Talking math</h2> <div align="center"> <img src="https://media.giphy.com/media/26xBI73gWquCBBCDe/giphy.gif" /> </div> <p>The operation, as said before, is very similar to standard matrix multiplication. The differences begin with the size of the final matrix. When in the mode <em>full</em>, the resulting matrix C has the size <em>m</em> that combines the size of the kernel matrix K and the image B, as the equation below shows:</p> <script type="math/tex; mode=display">m = |K| + |B| - 1</script> <p>The values of <script type="math/tex">C</script> are obtained by multiplying K and B.</p> <script type="math/tex; mode=display">C(i, j) = \sum_{p=0}^{i+1} \sum_{q=0}^{j+1} K(p,q) B(i - p + 1, j - q + 1)</script> <p>where <script type="math/tex">i</script> and <script type="math/tex">j</script> are some positions in <script type="math/tex">C</script>, and the notation <script type="math/tex">M(a, b)</script> denotes the element on the a-th row and b-th column.</p> <h2 id="convolute-and-learn">Convolute and learn</h2> <p>The inspiration for using the idea of convolution to build a machine learning technique comes from a biological mechanism present in the brain of mammals. The visual cortex contains groups of neurons that are modulated by <strong>receptive fields</strong>, that “<a href="https://en.wikipedia.org/wiki/Receptive_field">can elicit neuronal responses when stimulated</a>”. Receptive fields overlap and repeat between neighboring cells, so they act as local filters over what they receive.</p> <p>The <a href="https://doi.org/10.1113%2Fjphysiol.1968.sp008455">study</a>, that brings information about that region, divides the cells into two types: <em>simple</em>, that respond to specific patterns from within its receptive field; and <em>complex</em>, that have larger receptive fields and are insensitive to the exact position of the pattern in the area.</p> <h2 id="final-thoughts">Final thoughts</h2> <p>It is important (and also interesting!) to learn about all the steps in the computational learning process, and it is especially powerful to understand the reason why the model was built in a particular way. In the next posts, we will continue to see some theory and then dissect and train a <del>really</del> deep learning model.</p> <p>Stay tuned!</p> <h2 id="further-reading--references">Further reading &amp; references</h2> <p><a href="https://docs.opencv.org/master/d2/d96/tutorial_py_table_of_contents_imgproc.html">Image processing with OpenCV</a></p> <p><a href="https://cs231n.github.io/convolutional-networks/">CS123N</a></p> <p><a href="https://www.nature.com/articles/s42003-018-0110-y">Activations of DCNNs are aligned with gamma band activty of human visual cortex</a></p> <p><a href="https://books.google.com/books?id=8YrxWojxUA4C&amp;pg=PA106">Brain and the visual perception</a></p> <p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1363130">Receptive fields of single neurones in the cat’s striate cortex</a></p> <br> <a href="https://twitter.com/intent/tweet?text=via @nymaryah: http://localhost:4000/cnns-the-convolution/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/cnns-the-convolution/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/cnns-the-convolution/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="http://localhost:4000/cnns-a-convolucao/" class="pagination_pager" title="CNNS: A convolução ">previous</a> <a href="http://localhost:4000/portfolio-automatizado-no-readme/" class="pagination_pager" title="Portfólio automatizado no README ">next</a> </nav> </div> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <script type="text/javascript"> /* Set the width of the sidebar to 250px (show it) */ function openNav() { $('div.block-left').show(); $('.block-right').css('width', '60%'); $('#menu-right').hide(); } /* Set the width of the sidebar to 0 (hide it) */ function closeNav() { $('div.block-left').hide(); $('.block-right').css('width', '100%'); $('#menu-right').show(); } </script> </body> </html>
