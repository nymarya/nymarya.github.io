<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Portfólio automatizado no README &#8211; Mayra Azevedo</title> <meta name="description" content="No dia 10 de julho de 2020, estava eu calmamente navegando pela minha timeline do Twiter, quando me aparece o tweet abaixo:"> <meta name="keywords" content="python, github actions, readme"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://avatars0.githubusercontent.com/u/23341788?s=460&v=4"> <meta name="twitter:title" content="Portfólio automatizado no README"> <meta name="twitter:description" content="No dia 10 de julho de 2020, estava eu calmamente navegando pela minha timeline do Twiter, quando me aparece o tweet abaixo:"> <meta name="twitter:site" content="@nymaryah"> <meta name="twitter:creator" content="@nymaryah"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Portfólio automatizado no README"> <meta property="og:description" content="No dia 10 de julho de 2020, estava eu calmamente navegando pela minha timeline do Twiter, quando me aparece o tweet abaixo:"> <meta property="og:url" content="http://localhost:4000/portfolio-automatizado-no-readme/"> <meta property="og:site_name" content="Mayra Azevedo"> <meta property="og:image" content="http://localhost:4000/images/https://avatars0.githubusercontent.com/u/23341788?s=460&v=4"> <link rel="canonical" href="http://localhost:4000/portfolio-automatizado-no-readme/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Mayra Azevedo" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/workset.jpeg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/workset.jpeg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/natown.jpg) no-repeat;background-size: cover;} </style> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'></script> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.css" type="text/css" /> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.css" type="text/css" /> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.js"></script> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.js"></script> <script type="text/javascript"> Bokeh.set_log_level("info"); </script> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <div style="position:absolute; bottom: -10px; top:0; left:-30px; right:0"> <button class="pull-right" onclick="closeNav()" style="background: rgb(255,255,255,0); border-color: rgb(255,255,255,0)"> <i class="material-icons pull-right" style="color: white; font-size: 40px"> menu </i> </button> </div> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Portfólio automatizado no README </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#python">python</a></li> <li><a href="http://localhost:4000/tags#github actions">github actions</a></li> <li><a href="http://localhost:4000/tags#readme">readme</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts"><i class="material-icons"> arrow_back </i>Voltar para posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div style="display: none" id="menu-right"> <button class="pull-right" style="background: rgb(255,255,255,0); border-color: rgb(255,255,255,0)" onclick="openNav()"> <i class="material-icons pull-right" style="color: black; font-size: 40px"> menu </i> </button> </div> <a href="http://localhost:4000" title="home" class="home-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">15/07/2020</div> <p>No dia 10 de julho de 2020, estava eu calmamente navegando pela minha timeline do Twiter, quando me aparece o tweet abaixo:</p> <div> <blockquote class="twitter-tweet"><p lang="en" dir="ltr">Made myself a self-updating GitHub personal README! It uses a GitHub Action to update itself with my latest GitHub releases, blog entries and TILs <a href="https://t.co/Eve7FOrwYK">https://t.co/Eve7FOrwYK</a> <a href="https://t.co/oJPXLtFdgM">pic.twitter.com/oJPXLtFdgM</a></p>&mdash; Simon Willison (@simonw) <a href="https://twitter.com/simonw/status/1281435464474324993?ref_src=twsrc%5Etfw">July 10, 2020</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> </div> <p>Para um desenvolvedor sua existência já está resumida na própria bio do GitHub, na página <a href="https://nymarya.github.io">about</a> do site pessoal, na descrição do LinkedIn, às vezes até na descrição do Twitter, e com a possibilidade de automatizar. Depois da invenção do Simon, a feature nova pareceu mais interessante, podendo dar um diferencial em relação às outras de poder trazer informações sintetizadas que não precisam ser ajustadas manualmente (e consequentemente esquecidas de serem atualizadas).</p> <h3 id="começando-a-automatização-readme">Começando a automatização README</h3> <p>O primeiro passo é escolher quais informações devem aparecer. No meu caso, queria mostrar os posts e um resumo do que tem no meu GitHub, as linguagens que estão presentes nele.</p> <p>O próprio resumo escolhi escrever manualmente por motivos de: queria usar emoticons; queria escrever em inglês e português; algumas informações são pessoais, como os hobbies, e não encontraria lugares de onde tirar a informação; e até poderia criar um script que simplemente acrescenta o texto que eu escolhi, mas não acho que ficaria um código bonito e organizado.</p> <p>Pensado isso, é hora de colocar a mão no código.</p> <h3 id="inserindo-posts-com-beautifulsoup">Inserindo posts com BeautifulSoup</h3> <p>Simon em seu <a href="https://simonwillison.net/2020/Jul/10/self-updating-profile-readme/">post</a> usa uma forma mais robusta e organizada para recuperar os posts, mas infelizmente meu blog no Github Pages não me dá as mesmas ferramentas. Porém, como a estrutura do HTML é bem organizada, não foi difícil recuperar o que eu queria.</p> <p>A biblioteca <a href="https://pypi.org/project/beautifulsoup4/">BeautifulSoup</a> é ótima para minerar informações de sites. Para pegar os posts separados por cada língua, recuperei o HTML da <a href="https://nymarya.github.io/categories">página</a> onde os posts já estão divididos, identifiquei onde fica cada categoria, e simplemente salvei o endereço, título e data do número de links que eu queria. O código todo, que tem aproximadamente 30 linhas) está <a href="https://github.com/nymarya/nymarya/blob/master/posts.py">aqui</a>.</p> <h3 id="inserindo-resumo-das-linguagens">Inserindo resumo das linguagens</h3> <p>Mais uma vez, Simon utilizou uma forma um pouco mais elegante. Dessa vez, foi usando a API em GraphQl para recuperar informações do GitHub.</p> <p>Resolvi usar a API REST pela praticidade. Usei ela duas vezes: uma para recuperar os nomes dos repositórios (<code class="highlighter-rouge">https://api.github.com/users/&lt;usuario&gt;/repos</code>) e outra para recuperar as linguagens em cada repositório (<code class="highlighter-rouge">https://api.github.com/repos/&lt;usuario&gt;/&lt;repo&gt;/languages'</code>). A versão sem autenticação da API, além de acessar só os repositórios públicos, tem um limite de 60 requisições por hora, então para quem possui 60 repositórios públicos ou mais o recomendado é usar autenticação. Todas elas são consultadas utilizando a biblioteca requests.</p> <p>A resposta da segunda API consiste em um dicionário com cada linguagem e sua contagem de bytes. Assim, para saber a proporção basta ir unindo essas informações e no final calcular as porcentagens. Para a exibição, é usada uma tabela onde na primeira linha ficam as logos das ferramentas (boa parte das logos vem desse <a href="https://github.com/abranhe/programming-languages-logos">repositório</a> e na segunda os nome e as porcentagem de código em que são usadas. O código com todas essas funções está <a href="https://github.com/nymarya/nymarya/blob/master/repositories.py">aqui</a>.</p> <h3 id="agora-sim-a-automatização">Agora sim a automatização</h3> <p>Todo o processo de escrita no arquivo é feita no arquivo <a href="https://github.com/nymarya/nymarya/blob/master/build_readme.py">build_readme.py</a>. Mas para fazer o preenchimento do arquivo primeiro precisamos indicar no README.md aonde os textos vão ser colocados. Isso é feito com comentários no markdown, que marcam as seções:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- &lt;nome da seção&gt;</span> starts --&gt;
<span class="c">&lt;!-- &lt;nome da seção&gt;</span> ends --&gt;
</code></pre></div></div> <p>Daí, usando a biblioteca <code class="highlighter-rouge">re</code> podemos usar expressões regulares para identificar esses blocos. A expressão usada é <code class="highlighter-rouge">"&lt;!-- &lt;nome da seção&gt; starts --&gt;.*&lt;!-- &lt;nome da seção&gt; ends --&gt;"</code>. Na hora de inserir o texto, os comentários se mantém, para na próxima atualização a seção poder ser encontrada novamente, e os caracteres <code class="highlighter-rouge">.*</code> são substituídos pelo conteúdo de fato, consequentemente também reescrevendo o texto anterior.</p> <p>O passo final é configurar o workflow no Github Actions. Isso é feito indo para a aba específica, escolhendo “set up a workflow yourself” e então adicionando os comandos para configurar o Python e o pip, instalar dependências que estão no requeirements.txt, atualizar o README.md e finalmente dar commit no resultado, além de ajustar o cron para que a tarefa rode a cada 1 hora, entre 1:00 e 23:00. Ao salvar o <code class="highlighter-rouge">main.yml</code> que contém as configurações na pasta <code class="highlighter-rouge">.github/workflows</code>, o GitHub Actions vai identificar o arquivo. O workflow é basicamente o mesmo do Simon, a diferença é que o dele ainda inclui um comando para pegar variáveis de ambiente.</p> <h3 id="para-quem-tiver-mais-tempo-e-disposição">Para quem tiver mais tempo e disposição</h3> <p>Existe uma série de coisas que poderiam ser automatizadas. Os releases mais recentes (como Simon fez), contagem de commits, interações no StackOverflow (não olhei se eles tem API, se não tiverem certamente o BeautifulSoup resolve), trabalho atual e formação do LinkedIn (se tiverem API deve ser paga, então novamente poderia usar BeautifulSoup), publicações no LinkedIn, posts do Medium, vídeos ou episódios de podcasts mais recentes para quem é desse mundo, e por aí vai.</p> <p>Ansiosa para ver quais ideias vão surgir. Até mais!</p> <h2 id="links">Links</h2> <p><a href="https://simonwillison.net/2020/Jul/10/self-updating-profile-readme/">Post do Simon onde ele explica o que ele fez</a></p> <p><a href="https://simonwillison.net/2020/Apr/20/self-rewriting-readme/">Outro post do Simon sobre automatização do README</a></p> <br> <a href="https://twitter.com/intent/tweet?text=via @nymaryah: http://localhost:4000/portfolio-automatizado-no-readme/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/portfolio-automatizado-no-readme/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/portfolio-automatizado-no-readme/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="http://localhost:4000/cnns-the-convolution/" class="pagination_pager" title="CNNS: The convolution ">previous</a> <a href="http://localhost:4000/self-updating-portfolio-on-readme/" class="pagination_pager" title="Self-updating portfolio on README ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <script type="text/javascript"> /* Set the width of the sidebar to 250px (show it) */ function openNav() { $('div.block-left').show(); $('.block-right').css('width', '60%'); $('#menu-right').hide(); } /* Set the width of the sidebar to 0 (hide it) */ function closeNav() { $('div.block-left').hide(); $('.block-right').css('width', '100%'); $('#menu-right').show(); } </script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(https://github.com/nymarya/nymarya.github.io/blob/master/images/retsus.png?raw=true) center center no-repeat;"> <a href="https://retsus.ufrn.br" target="_blank" rel="nofollow external"> <span> RETSUS </span> </a> </li> <li style="background:url(https://github.com/nymarya/nymarya.github.io/blob/master/images/sgp.png?raw=true) center center no-repeat;"> <a href="http://sgp.lais.huol.ufrn.br" target="_blank" rel="nofollow external"> <span> SGP </span> </a> </li> <li style="background:url(http://localhost:4000/) center center no-repeat;"> <a href="" target="_blank" rel="nofollow external"> <span> Olho Biônico </span> </a> </li> <li style="background:url(http://localhost:4000/) center center no-repeat;"> <a href="" target="_blank" rel="nofollow external"> <span> PRODOC </span> </a> </li> <li style="background:url(http://adcon.rn.gov.br/ACERVO/seec/IMG/IMG000000000176382.JPEG) center center no-repeat;"> <a href="http://www.educacao.rn.gov.br/Conteudo.asp?TRAN=ITEM&TARG=176381&ACT=&PAGE=&PARM=&LBL=MAT%C9RIA" target="_blank" rel="nofollow external"> <span> Comunica-EDU </span> </a> </li> </ul> </div> </body> </html>
