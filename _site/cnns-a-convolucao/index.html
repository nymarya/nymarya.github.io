<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>CNNS: A convolução &#8211; Mayra Azevedo</title> <meta name="description" content="Este é o primeiro post de uma série sobre deep learning, especialmente Redes Neurais Convolucionais (em inglês: Convolutional Neural Networks, ou CNNs) que consiste de dois post teóricos e um mais prático, discorrendo sobre um modelo específico. Vamos começar com o C da sigla em inglês, CNN."> <meta name="keywords" content="deep learning, CNN"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://i.stack.imgur.com/VC1TX.png"> <meta name="twitter:title" content="CNNS: A convolução"> <meta name="twitter:description" content="Este é o primeiro post de uma série sobre deep learning, especialmente Redes Neurais Convolucionais (em inglês: Convolutional Neural Networks, ou CNNs) que consiste de dois post teóricos e um mais prático, discorrendo sobre um modelo específico. Vamos começar com o C da sigla em inglês, CNN."> <meta name="twitter:site" content="@mayradazevedo"> <meta name="twitter:creator" content="@mayradazevedo"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="CNNS: A convolução"> <meta property="og:description" content="Este é o primeiro post de uma série sobre deep learning, especialmente Redes Neurais Convolucionais (em inglês: Convolutional Neural Networks, ou CNNs) que consiste de dois post teóricos e um mais prático, discorrendo sobre um modelo específico. Vamos começar com o C da sigla em inglês, CNN."> <meta property="og:url" content="https://nymarya.github.io/cnns-a-convolucao/"> <meta property="og:site_name" content="Mayra Azevedo"> <meta property="og:image" content="https://nymarya.github.io/images/https://avatars0.githubusercontent.com/u/23341788?s=460&v=4"> <link rel="canonical" href="https://nymarya.github.io/cnns-a-convolucao/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="https://nymarya.github.io/feed.xml" title="Mayra Azevedo" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="https://nymarya.github.io/favicon.png" /> <link rel="shortcut icon" href="https://nymarya.github.io/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="https://nymarya.github.io/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-post {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://i.stack.imgur.com/VC1TX.png) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://nymarya.github.io/images/w1.jpeg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(https://nymarya.github.io/images/natown.jpg) no-repeat;background-size: cover;} </style> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'></script> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.css" type="text/css" /> <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.css" type="text/css" /> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.0.4.min.js"></script> <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.0.4.min.js"></script> <script type="text/javascript"> Bokeh.set_log_level("info"); </script> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"> <style> a {color: black;} a:hover { color: #8f6bff; } </style> </head> <body id="posts" class="inner-post-page"> <header class="navbar navbar-expand navbar-dark flex-column flex-row-reverse bd-navbar"> <div class="d-flex flex-row-reverse bd-highlight pull-right"> <div class="p-2 bd-highlight"> <a title="projects" href="../projects.html" > Projects </a> </div> <div class="p-2 bd-highlight"> <a href="../posts.html" title="posts">Posts</a> </div> <div class="p-2 bd-highlight"> <a href="https://nymarya.github.io" title="home" style="font-family: 'Raleway','Helvetica Neue',Helvetica,Arial,sans-serif; font-weight: 500">Home</a></div> </div> </header> <div style="height: 90%; overflow: auto;"> <div class="block-post"> <div class="content"> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">CNNS: A convolução </h1> <ul class="tags"> <li><a href="https://nymarya.github.io/tags#deep learning">deep learning</a></li> <li><a href="https://nymarya.github.io/tags#CNN">CNN</a></li> </ul> <div class="section-line reverse"> <em>/</em></div> </div> </div> </div> <div class="post"> <div class="inner-post post-content"> <div class="date-highlight">17/11/2019</div> <p>Este é o primeiro post de uma série sobre deep learning, especialmente Redes Neurais Convolucionais (em inglês: Convolutional Neural Networks, ou CNNs) que consiste de dois post teóricos e um mais prático, discorrendo sobre um modelo específico. Vamos começar com o C da sigla em inglês, CNN.</p> <p><strong>Convolução</strong> é um termo usado na área da matemática para descrever a operação sobre duas funções que produzem uma terceira função expressando como a primeira é modificada pela outra. Eu sempre me recordo de uma aula na qual o professor explicou esse conceito de uma maneira bem simples. Imagine que você está entre dois palcos durante um festival de música: se você se mover em direção a um ou outro, ouvirá melhor alguma das músicas. Se ficar no meio, os sinais ficam muito misturados. Esta confusão de ruídos é a convolução em ação.</p> <h2 id="sobre-imagens">Sobre imagens</h2> <div align="center"> <img src="https://media.giphy.com/media/8b5gDEqjO5BKM/giphy.gif" /> </div> <p>Primeiro, o básico de imagens. Para o computador, uma imagem não passa de de uma matrix de inteiros. Quando a imagem é em tons de cinza, cada número entre 0 e 255 representa a luminosidade de um pixel. Existem duas maneiras de representar figuras RGB. A primeira é como um grupo de 3 inteiros que compoem um pixel, com cada elemento do trio representando o valor de vermelho, verde e azul, respectivamente. Na outra forma, a imagem possui dimensões mxnx3, tendo uma camada para cada cor.</p> <p>Em relação a processamento de imagens, convolucionar significa executar várias multiplicações de matrizes entre a matrix que representa a imagem e a [máscara](https://en.wikipedia.org/wiki/Kernel_(image_processing). Deste modo, nós podemos aplicar filtros, seja para detecção de bordas, efeitos de blurring ou de sharpening.</p> <h2 id="tipos-de-convolução-de-imagem">Tipos de convolução de imagem</h2> <p>Embora uma multiplicação de matrizes convencional requeira que o número de colunas da primeira matrix seja igual ao número de linhas da segunda matriz, o processo de convolução não possui este tipo de condição. As dimensões do kernel não precisam bater com as da imagem, visto que a convolução não equivale a um produto convecional. Ao invés disso, a operação é realizada sucessivamente sobre a figura, como se fosse uma janela deslizante movendo sobre a imagem.</p> <p>Considerando que os formatos não estão adequados, existem tipos de convolução cujos resultos tem dimensões diferentes. O método <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve2d.html">convolve</a> do módulo scipy possui três modos: <em>full</em>, no qual os sinais não se sobrepõe completamente nas bordas da operação e podem acontecer efeitos nas bordas; <em>same</em>, no qual o resultado tem o mesmo tamanho da imagem; e <em>valid</em>, onde o product consiste apenas dos elementos que não dependem de zero-padding.</p> <h2 id="sobre-matemática">Sobre matemática</h2> <div align="center"> <img src="https://media.giphy.com/media/26xBI73gWquCBBCDe/giphy.gif" /> </div> <p>A operação, como dito anteriormente, é muito similiar à multiplicação de matrizes comum. As diferenças começãm com o tamanho da matriz final. No modo <em>full</em>, a matriz resultante C tem tamanho <em>m</em> que combina o tamanho da matriz kernel K e a imagem B, conforma a equação abaixo:</p> \[m = |K| + |B| - 1\] <p>Os valores de \(C\) são obtidos ao multiplicar K e B.</p> \[C(i, j) = \sum_{p=0}^{i+1} \sum_{q=0}^{j+1} K(p,q) B(i - p + 1, j - q + 1)\] <p>onde \(i\) e \(j\) são posições em \(C\), e a notação \(M(a, b)\) denota a elemento na a-ésima linha e b-ésima coluna.</p> <h2 id="convolucionar-para-aprender">Convolucionar para aprender</h2> <p>A inspiração de usar a ideia de convolução para construir um algoritmo de aprendizado de máquina vem de um mecanismo biológico encontrado no cérebro de mamíferos. O córtex visual contem grupos de neurônios que são modulados por <strong>campos receptivos</strong>, que “<a href="https://en.wikipedia.org/wiki/Receptive_field">podem provocar reações neurais quando estimuladas</a>”. Campos receptivos podem se sobrepor e repetir entre células visiznhas, de forma que atuam como filtros locais sobre o que recebem.</p> <p>O <a href="https://doi.org/10.1113%2Fjphysiol.1968.sp008455">estudo</a>, que traz informações sobre a região, divide as células em dois tipos: <em>simples</em>, que reagem a padrões específicos de seu campo receptivo; e <em>complexas</em>, que tem campos receptivos maiores e não são sensíveis à exata posição de um padrão na área.</p> <h2 id="discussão">Discussão</h2> <p>É importante (além de interessante! ) aprender sobre todos os passos no processo do aprendizado computacional, e é especialmente poderoso enteder a razão pela qual o modelo foi criado de certa maneira. Nos próximos posts, vamos continuar a ver teoria e depois investigar e treinar um modelo de deep learning. Até mais!</p> <h2 id="para-saber-mais--referências">Para saber mais &amp; referências</h2> <p><a href="https://docs.opencv.org/master/d2/d96/tutorial_py_table_of_contents_imgproc.html">Processamento de imagens com OpenCV</a></p> <p><a href="https://cs231n.github.io/convolutional-networks/">CS123N</a></p> <p><a href="https://www.nature.com/articles/s42003-018-0110-y">Activations of DCNNs are aligned with gamma band activty of human visual cortex</a></p> <p><a href="https://books.google.com/books?id=8YrxWojxUA4C&amp;pg=PA106">Brain and the visual perception</a></p> <p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1363130">Receptive fields of single neurones in the cat’s striate cortex</a></p> <br> <a href="https://twitter.com/intent/tweet?text=via @nymaryah: https://nymarya.github.io/cnns-a-convolucao/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://nymarya.github.io/cnns-a-convolucao/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <br> <script async src="https://telegram.org/js/telegram-widget.js?11" data-telegram-share-url="https://nymarya.github.io/cnns-a-convolucao/" data-comment="Via nymaryah: " data-size="large" class="btn"></script> <nav class="pagination"> <a href="https://nymarya.github.io/do-que-politicos-estao-falando/" class="pagination_pager" title="Do que os políticos estão falando? ">previous</a> <a href="https://nymarya.github.io/cnns-the-convolution/" class="pagination_pager" title="CNNS: The convolution ">next</a> </nav> </div> </div> </div> <!-- JS --> <script src="https://nymarya.github.io/assets/js/main.min.js"></script> <script type="text/javascript"> /* Set the width of the sidebar to 250px (show it) */ function openNav() { $('div.block-left').show(); $('.block-right').css('width', '60%'); $('#menu-right').hide(); } /* Set the width of the sidebar to 0 (hide it) */ function closeNav() { $('div.block-left').hide(); $('.block-right').css('width', '100%'); $('#menu-right').show(); } </script> </body> </html>
